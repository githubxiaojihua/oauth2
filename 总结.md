**先阅读一下阮一峰的《理解OAuth2.0》**

# 一、测试流程
1. 使用maven tomcat7插件运行zetark-oauth2-server。
2. 注册应用：打开http://localhost:8080/zetark-oauth2-server/client，可以看到当前可用的客户端应用，也可以注册新的。
3. 请求授权码：
    http://localhost:8080/zetark-oauth2-server/authorize?client_id=c1ebe466-1cdc-4bd3-ab69-77c3561b9dee&response_type=code&redirect_uri=http://aimeizi.net
    参数说明
    client_id               应用id
    response_type           返回授权码的标识
    redirect_uri            回调地址
    上面的网站会打开oauth server的用户登录页面。用户输入正确的用户名和密码以POST方式提交后会重定向到用户所填的回调地址并在地址后携带授权码.
    请求成功后会返回如下的页面:
    http://aimeizi.net/?code=63910432da9186b22b1ad888d55ae8ae
    这里code=63910432da9186b22b1ad888d55ae8ae 即授权码。
4. 使用授权码换取accessToken(Post操作)---这一步一般是在客户端的后台服务器中完成的，对于用户是不可见的。
    首先GET方式请求http://localhost:8080/zetark-oauth2-server/access会打开一个表单在该表单中填入必填项，具体表单参数详见说明部分
    表单将会以POST方式提交到http://localhost:8080/zetark-oauth2-server/accessToken,最终返回accessToken
   
    需要以POST方式提交以下参数换取accessToken
    client_id       c1ebe466-1cdc-4bd3-ab69-77c3561b9dee            应用id
    client_secret   d8346ea2-6017-43ed-ad68-19c0f971738b            应用secret
    grant_type      authorization_code                              用于传递授权码的参数名authorization_code
    code            63910432da9186b22b1ad888d55ae8ae                用户登录授权后的授权码
    redirect_uri    http://aimeizi.net                              回调地址
    最终返回如下数据
    {"expires_in":3600,"access_token":"223ae05dfbb0794396fb60a0960c197e"}
5. 使用access_token来获取用户信息
   http://localhost:8080/zetark-oauth2-server/v1/openapi/userInfo?access_token=223ae05dfbb0794396fb60a0960c197e
   测试ok的话返回用户名信息,access_token=223ae05dfbb0794396fb60a0960c197e为上一步获取的access_token
   **注：其中的参数名不要随意更改，固定写法。**
   
# 二、程序相关说明
1. 配置文件与shiro教程中的16章代码差不多，这里就不多说了。
2. 项目使用了oltu\spring\springMvc\shiro(权用做密码加密)
3. 项目按照OAuth2.0的规范进行编码，同时使用oltu的相关API。本项目可以做为一个使用oltu的样例。
4. oltu是OAuth2.0的java实现，但是从2018年开始就被apache放弃了，但是还是可以使用的。
5. 请求授权码：AuthorizeController的authorize方法来处理 授权码请求。相关说明参考代码中的注释。
   另外方法的返回值使用了ResponseEntity，这个代表了http响应，可以对http响应做完全的自定义配置。
   一般情况下使用@ResponseBody就行，作用基本一致。
   相关文章可以参考笔记中的springmvc\springresponseentity的使用。
6. 换取accessToken：AccessTokenController的token方法来处理 换取accessToken请求。相关说明参考代码中的
   注释。主要还是跟上面的差不多，构建OAuth请求、检验授权码、使用OAuthIssuerImpl生成accessToken，这都是
   标准的oltu API，然后放入缓存生成相关响应(token及过期时间)。
7. 使用token来调用开放API
   URL URLConnection相关知识
**注：本例没有实现token刷新**
